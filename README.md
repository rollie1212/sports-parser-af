# Sports Parser AF

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–µ—Ä —Ñ—É—Ç–±–æ–ª—å–Ω—ã—Ö –º–∞—Ç—á–µ–π –∏–∑ API-Football —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ MongoDB –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥** –º–∞—Ç—á–µ–π –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- **TTL –∏–Ω–¥–µ–∫—Å—ã** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä
- **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤** (NS ‚Üí POSTPONED ‚Üí CANCELLED)
- **REST API** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–π** (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- **üñºÔ∏è BunnyCDN –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –∫–æ–º–∞–Ω–¥, –ª–∏–≥, –∏–≥—Ä–æ–∫–æ–≤
- **üåç –ì–ª–æ–±–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞** –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ CDN

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- MongoDB
- API-Football –∫–ª—é—á

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/yourusername/sports-parser-af.git
cd sports-parser-af
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```

3. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
MONGO_URI=mongodb://localhost:27017/football-bot
API_KEY=your_api_football_key
PORT=3000
FETCH_INTERVAL_MINUTES=1
DAYS_AHEAD=5

# BunnyCDN Configuration (Optional)
ENABLE_BUNNY_CDN=false
BUNNY_CDN_URL=https://your-pull-zone.b-cdn.net
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–µ—Ä:
```bash
npm start
```

## üîß API Endpoints

### Health Check
```
GET /health
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞.

### Upcoming Fixtures
```
GET /fixtures/upcoming
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–∞—Ç—á–∏ (NS, LIVE —Å—Ç–∞—Ç—É—Å—ã).

### Manual Fixture Update
```
GET /fixtures/update/:fixtureId
```
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–∞—Ç—á –∏–∑ API.

### Image Optimization Endpoints
```
GET /images/team/:teamId?width=100&height=100&quality=85
GET /images/league/:leagueId?width=80&height=80&quality=85
GET /images/player/:playerId?width=150&height=150&quality=85
GET /images/venue/:venueId?width=300&height=200&quality=85
GET /images/country/:countryCode?width=40&height=30&quality=85
GET /images/status
```
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ BunnyCDN.

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–ª–ª–µ–∫—Ü–∏—è: fixtures

```javascript
{
  fixtureId: Number,        // ID –º–∞—Ç—á–∞ –∏–∑ API
  league: String,           // –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏–≥–∏
  country: String,          // –°—Ç—Ä–∞–Ω–∞
  home: String,             // –î–æ–º–∞—à–Ω—è—è –∫–æ–º–∞–Ω–¥–∞
  away: String,             // –ì–æ—Å—Ç–µ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞
  date: String,             // ISO –¥–∞—Ç–∞ –º–∞—Ç—á–∞
  startTs: Number,          // Timestamp –Ω–∞—á–∞–ª–∞
  status: String,           // NS, LIVE, FT, CANCELLED, POSTPONED
  score: {
    home: Number,           // –ì–æ–ª—ã –¥–æ–º–∞—à–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã
    away: Number            // –ì–æ–ª—ã –≥–æ—Å—Ç–µ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
  },
  rawStatus: Object,        // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∏–∑ API
  finishedAt: Date,         // –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è (–¥–ª—è TTL)
  updatedAt: Date,          // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  simulated: Boolean,       // –§–ª–∞–≥ —Å–∏–º—É–ª—è—Ü–∏–∏
  closeReason: String,      // –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
  cleanupReason: String,    // –ü—Ä–∏—á–∏–Ω–∞ –æ—á–∏—Å—Ç–∫–∏
  images: {                 // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    homeTeamLogo: String,   // –õ–æ–≥–æ—Ç–∏–ø –¥–æ–º–∞—à–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã
    awayTeamLogo: String,   // –õ–æ–≥–æ—Ç–∏–ø –≥–æ—Å—Ç–µ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
    leagueLogo: String,     // –õ–æ–≥–æ—Ç–∏–ø –ª–∏–≥–∏
    countryFlag: String,    // –§–ª–∞–≥ —Å—Ç—Ä–∞–Ω—ã
    venueImage: String      // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞–¥–∏–æ–Ω–∞
  }
}
```

### –ò–Ω–¥–µ–∫—Å—ã

- `{ fixtureId: 1 }` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
- `{ startTs: 1 }` - –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- `{ status: 1 }` - –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É
- `{ finishedAt: 1 }` - TTL –∏–Ω–¥–µ–∫—Å (24 —á–∞—Å–∞)

## üßπ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

### TTL (Time To Live)
- **FT –∏–≥—Ä—ã**: —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- **CANCELLED –∏–≥—Ä—ã**: —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ `startTs`
- **POSTPONED –∏–≥—Ä—ã**: —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ `startTs`

### –õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è NS –∏–≥—Ä
- **24-48 —á–∞—Å–æ–≤**: –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ `POSTPONED`
- **–°—Ç–∞—Ä—à–µ 48 —á–∞—Å–æ–≤**: –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ `CANCELLED`

### –°–∫—Ä–∏–ø—Ç—ã –æ—á–∏—Å—Ç–∫–∏
```bash
# –ê–Ω–∞–ª–∏–∑ –∏ –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä
node scripts/cleanup-old-games.js
```

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Railway

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Railway
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `MONGO_URI` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB
   - `API_KEY` - –∫–ª—é—á API-Football
   - `PORT` - –ø–æ—Ä—Ç (Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `FETCH_INTERVAL_MINUTES` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - `DAYS_AHEAD` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –≤–ø–µ—Ä–µ–¥

3. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –ø–∞—Ä—Å–µ—Ä

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü–∞—Ä—Å–µ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –º–∞—Ç—á–µ–π
- –ó–∞–∫—Ä—ã—Ç—ã–µ —Å—Ç–∞—Ä—ã–µ NS –∏–≥—Ä—ã
- –û—á–∏—â–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã
- –û—à–∏–±–∫–∏ API –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üîÑ –¶–∏–∫–ª —Ä–∞–±–æ—Ç—ã

1. **–ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É**:
   - –ü–æ–ª—É—á–∞–µ—Ç –º–∞—Ç—á–∏ –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ç—á–∏
   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ NS –∏–≥—Ä—ã
   - –û—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã

2. **TTL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∏–≥—Ä—ã —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞

## üñºÔ∏è BunnyCDN Integration

–î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ BunnyCDN:

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ BunnyCDN**: –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ [BUNNY_CDN_SETUP.md](./BUNNY_CDN_SETUP.md)
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `npm run test:bunnycdn`
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: `GET /images/status`

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ BunnyCDN:
- ‚ö° **60-80% –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤** (WebP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
- üåç **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞** —á–µ—Ä–µ–∑ CDN
- üí∞ **–°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç** –Ω–∞ bandwidth
- üöÄ **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏
npm run dev:optimized

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä
node scripts/cleanup-old-games.js

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ BunnyCDN
npm run test:bunnycdn

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:3000/health
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
